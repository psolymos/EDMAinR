<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Parametric estimation • EDMAinR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Parametric estimation">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EDMAinR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/edma01-data.html">EDMA data</a>
    </li>
    <li>
      <a href="../articles/edma02-form.html">EDMA form matrix</a>
    </li>
    <li>
      <a href="../articles/edma03-parametric.html">Parametric estimation</a>
    </li>
    <li>
      <a href="../articles/edma04-form-difference.html">EDMA form difference matrix</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Parametric estimation</h1>
                        <h4 class="author">Peter Solymos</h4>
            
      
      
      <div class="hidden name"><code>edma03-parametric.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This section describes how to assess if SigmaK is estimable. We use a non-parametric model fit to begin with that has the estimate of the form matrix and the SigmaKstar matrix. The parametric estimation requires a pattern matrix that describes the unknowns in the SigmaK matrix. This SigmaK matrix is the variance covariance matrix describing the variances (diagonal) associated with each landmark, and the covariances (off-diagonal) among the landmarks.</p>
</div>
<div id="pattern-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#pattern-matrix" class="anchor"></a>Pattern matrix</h2>
<p>The pattern matrix describes the unknowns in the SigmaK matrix:</p>
<ul>
<li>the 1st row describes the landmarks starting from the 2nd column,</li>
<li>the 1st column describes the landmarks in the same order as the column headers,</li>
<li>leave the cell in the topleft corner empty,</li>
<li>use unique names or numbers in the rest of the table to denote unique variables in the Sigma matrix,</li>
<li>structural zeros (cells where the covariance is known or assumed to be 0) have to be blank,</li>
<li>there cannot be blank cells in the diagonal of the matrix,</li>
<li>values below and above the diagonal must be symmetric (value in row 2/column 3 must be the same as row 3/column 2), either unique names or numbers, or blank.</li>
</ul>
<p>The construction of the pattern matrix should be dome using biological reasoning. E.g. structural zeros can indicate that groups of landmarks might be correlated within the group, but not correlated among the groups.</p>
<p>This file can be created in R, or loaded as a csv or Excel (xls, xlsx) file:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(EDMAinR)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co">#&gt; EDMAinR 0.1-1     2020-02-16</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">  <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="ot">NA</span>,             <span class="co"># row 1</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">    <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="ot">NA</span>,             <span class="co"># row 2</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">    <span class="ot">NA</span>,  <span class="ot">NA</span>,  <span class="st">"1"</span>),           <span class="co"># row 3</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8">  <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>, <span class="co"># dimensions</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">  <span class="dt">dimnames=</span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">    <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>),         <span class="co"># row names</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11">    <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>)          <span class="co"># column names</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12">  ))</a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#&gt;   a   b   c  </span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt; a "1" "2" NA </span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#&gt; b "2" "1" NA </span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co">#&gt; c NA  NA  "1"</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"></a>
<a class="sourceLine" id="cb1-18" data-line-number="18">## read in csv</a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="kw"><a href="https://rdrr.io/pkg/EDMAinR/man/SigmaK_fit.html">read_pattern</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata/example.csv"</span>, <span class="dt">package=</span><span class="st">"EDMAinR"</span>))</a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="co">#&gt;   a   b   c  </span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co">#&gt; a "1" "2" NA </span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="co">#&gt; b "2" "1" NA </span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="co">#&gt; c NA  NA  "1"</span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"></a>
<a class="sourceLine" id="cb1-25" data-line-number="25">## read in xlsx</a>
<a class="sourceLine" id="cb1-26" data-line-number="26"><span class="kw"><a href="https://rdrr.io/pkg/EDMAinR/man/SigmaK_fit.html">read_pattern</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata/example.xlsx"</span>, <span class="dt">package=</span><span class="st">"EDMAinR"</span>))</a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="co">#&gt;   a   b   c  </span></a>
<a class="sourceLine" id="cb1-28" data-line-number="28"><span class="co">#&gt; a "1" "2" NA </span></a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="co">#&gt; b "2" "1" NA </span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30"><span class="co">#&gt; c NA  NA  "1"</span></a></code></pre></div>
</div>
<div id="simulated-example" class="section level2">
<h2 class="hasAnchor">
<a href="#simulated-example" class="anchor"></a>Simulated example</h2>
<p>This example has 4 landmarks, a corresponding form matrix (<code>M</code>)</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">M &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/structure.html">structure</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="fl">2.5</span>, <span class="fl">7.5</span>, <span class="fl">-2.5</span>, <span class="fl">-2.5</span>, <span class="fl">-7.5</span>, <span class="fl">2.5</span>, <span class="fl">2.5</span>, <span class="fl">4.5</span>),</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">    <span class="dt">.Dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(4L, 2L))</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">M</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; [1,] -2.5 -7.5</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; [2,]  7.5  2.5</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; [3,] -2.5  2.5</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; [4,] -2.5  4.5</span></a></code></pre></div>
<p>The true <code>SigmaK</code> matrix will have no covariance terms (<code>NA</code>s), we will set the variances for the first two the same (<code>"a"</code>), and the and the variances for the other two the same too (<code>"b"</code>), the values for the parameters are stored in the <code>parm</code> vector (<span class="math inline">\(a = 0.25\)</span>, <span class="math inline">\(b = 0.35\)</span>):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">parm &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">a=</span><span class="fl">0.25</span>, <span class="dt">b=</span><span class="fl">0.35</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">m &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">    <span class="st">"a"</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">    <span class="ot">NA</span>, <span class="st">"a"</span>, <span class="ot">NA</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">    <span class="ot">NA</span>,  <span class="ot">NA</span>, <span class="st">"b"</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">    <span class="ot">NA</span>,  <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"b"</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">), <span class="dv">4</span>, <span class="dv">4</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p>Finally, the <code>SigmaK</code> matrix based on the parameter values and the pattern matrix:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">SigmaK &lt;-<span class="st"> </span>EDMAinR<span class="op">:::</span><span class="kw">.vec2mat</span>(parm, EDMAinR<span class="op">:::</span><span class="kw">.mat2fac</span>(m))</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">SigmaK</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; [1,] 0.25 0.00 0.00 0.00</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; [2,] 0.00 0.25 0.00 0.00</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; [3,] 0.00 0.00 0.35 0.00</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt; [4,] 0.00 0.00 0.00 0.35</span></a></code></pre></div>
<p>We can use <code>M</code> and <code>SigmaK</code> matrix to simulate 500 specimens:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">sim &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/EDMAinR/man/edma_data.html">edma_simulate_data</a></span>(<span class="dt">n=</span><span class="dv">500</span>, M, SigmaK)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">sim</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; EDMA data: Simulated landmark data</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; 2 dimensions, 4 landmarks, 500 specimens</span></a></code></pre></div>
<p>The following few lines set the dimension names for <code>M</code> and <code>SigmaK</code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span>(M) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span>(sim<span class="op">$</span>data[[1L]])</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(SigmaK) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(m) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(sim<span class="op">$</span>data[[1L]])</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(SigmaK) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(m) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(sim<span class="op">$</span>data[[1L]])</a></code></pre></div>
<p>Now we have everything we need to estimate the form matrix, SigmaKstar, and SigmaK.</p>
</div>
<div id="parametric-estimation" class="section level2">
<h2 class="hasAnchor">
<a href="#parametric-estimation" class="anchor"></a>Parametric estimation</h2>
<p>The first step is to use the data set from our 500 simulated specimens and estimate mean form and SigmaKstar using the non-parametric estimation function <code>edma_fit</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/EDMAinR/man/edma_fit.html">edma_fit</a></span>(sim)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">fit</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; EDMA nonparametric fit: Simulated landmark data</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt; Call: edma_fit(x = sim)</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt; 2 dimensions, 4 landmarks, 500 replicates, no bootstrap</span></a></code></pre></div>
<p>Now we estimate SigmaK using <code>fit</code> and the pattern matrix <code>m</code> as arguments for the <code>SigmaK_fit</code> function:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">o &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/EDMAinR/man/SigmaK_fit.html">SigmaK_fit</a></span>(fit, m)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">o</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; EDMA parametric fit: Simulated landmark data</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; Call: SigmaK_fit(object = fit, pattern = m)</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt; 2 dimensions, 4 landmarks, 500 replicates, no bootstrap</span></a></code></pre></div>
<p>We can compare the estimates with our known parameters, because we used simulation, thus we know the truth. This is not the case for real cases, but this way we can check if our methods work. These are the individual parameters that make up the SigmaK matrix:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="dt">true=</span>parm, <span class="dt">est=</span>o<span class="op">$</span>results<span class="op">$</span>par)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#&gt;   true       est</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt; a 0.25 0.2539084</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; b 0.35 0.3209651</span></a></code></pre></div>
<p>And this is our estimated SigmaK matrix:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/pkg/EDMAinR/man/SigmaK_fit.html">SigmaK</a></span>(o)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt;           L1        L2        L3        L4</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt; L1 0.2539084 0.0000000 0.0000000 0.0000000</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; L2 0.0000000 0.2539084 0.0000000 0.0000000</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt; L3 0.0000000 0.0000000 0.3209651 0.0000000</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt; L4 0.0000000 0.0000000 0.0000000 0.3209651</span></a></code></pre></div>
</div>
<div id="sensitivity-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#sensitivity-analysis" class="anchor"></a>Sensitivity analysis</h2>
<p>We use sensitivity analysis to check how well we can estimate SigmaK. We need to do this, because we want to make sure the optimization routine is finding the same solutions no matter what initial values we use. This indicates that the estimates are in fact identifiable.</p>
<p>To check the sensitivity using the aptly named <code>sensitivity</code> function. This function re-estimates the SigmaK matrix multiple times with random starting values for numerical optimization. The result is a matrix with estimates of each parameter as columns. The last column contains the value of the loss function (used in the optimization) evaluated at the parameter values in that row. The rows represent the original estimates and the 10 re-estimated sets of values. The number of replicates can be increased further:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">s &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/EDMAinR/man/SigmaK_fit.html">sensitivity</a></span>(o, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">s</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt;           par_a     par_b        value</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt;  [1,] 0.2539084 0.3209651 0.0007728197</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt;  [2,] 0.2538729 0.3210012 0.0007728189</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt;  [3,] 0.2538583 0.3209854 0.0007728177</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt;  [4,] 0.2538704 0.3209634 0.0007728175</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt;  [5,] 0.2538549 0.3209625 0.0007728176</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#&gt;  [6,] 0.2538258 0.3209865 0.0007728194</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#&gt;  [7,] 0.2538159 0.3209421 0.0007728220</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#&gt;  [8,] 0.2538349 0.3209740 0.0007728185</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#&gt;  [9,] 0.2538266 0.3209903 0.0007728194</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co">#&gt; [10,] 0.2538954 0.3209989 0.0007728202</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="co">#&gt; [11,] 0.2538312 0.3210041 0.0007728198</span></a></code></pre></div>
<p>When we look at the results and see that the estimates are very similar (5th digit differences), this indicates that the parameters are identifiable. We can do this via the <code>summary</code> function or by looking at the <code>boxplot</code>:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(s)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#&gt;      par_a            par_b            value          </span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#&gt;  Min.   :0.2538   Min.   :0.3209   Min.   :0.0007728  </span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">#&gt;  1st Qu.:0.2538   1st Qu.:0.3210   1st Qu.:0.0007728  </span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt;  Median :0.2539   Median :0.3210   Median :0.0007728  </span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#&gt;  Mean   :0.2539   Mean   :0.3210   Mean   :0.0007728  </span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt;  3rd Qu.:0.2539   3rd Qu.:0.3210   3rd Qu.:0.0007728  </span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&gt;  Max.   :0.2539   Max.   :0.3210   Max.   :0.0007728</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(s)</a></code></pre></div>
<p><img src="edma03-parametric_files/figure-html/unnamed-chunk-12-1.png" width="576"></p>
</div>
<div id="non-estimability" class="section level2">
<h2 class="hasAnchor">
<a href="#non-estimability" class="anchor"></a>Non-estimability</h2>
<p>When estimates vary while the loss function value is the same, it is usually a sign of non-identifiability. Let’s see an example for this situation.</p>
<p>The simulation is very similar to the previous example. The only difference is that the pattern matrix has the <code>"a"</code> parameter describing the diagonal variance elements, the <code>"b"</code> parameter is put in all the off-diagonal cells, thus we have constant covariances:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">parm &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">a=</span><span class="fl">0.25</span>, <span class="dt">b=</span><span class="fl">0.07</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">m &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">    <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"b"</span>,</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">    <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"b"</span>,</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">    <span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>,</a>
<a class="sourceLine" id="cb13-6" data-line-number="6">    <span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"a"</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7">), <span class="dv">4</span>, <span class="dv">4</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb13-8" data-line-number="8">SigmaK &lt;-<span class="st"> </span>EDMAinR<span class="op">:::</span><span class="kw">.vec2mat</span>(parm, EDMAinR<span class="op">:::</span><span class="kw">.mat2fac</span>(m))</a>
<a class="sourceLine" id="cb13-9" data-line-number="9">SigmaK</a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">#&gt; [1,] 0.25 0.07 0.07 0.07</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">#&gt; [2,] 0.07 0.25 0.07 0.07</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="co">#&gt; [3,] 0.07 0.07 0.25 0.07</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co">#&gt; [4,] 0.07 0.07 0.07 0.25</span></a></code></pre></div>
<p>The rest of the simulation is the same as before:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">sim &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/EDMAinR/man/edma_data.html">edma_simulate_data</a></span>(<span class="dt">n=</span><span class="dv">500</span>, M, SigmaK)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span>(M) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span>(sim<span class="op">$</span>data[[1L]])</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(SigmaK) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(m) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(sim<span class="op">$</span>data[[1L]])</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(SigmaK) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(m) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(sim<span class="op">$</span>data[[1L]])</a></code></pre></div>
<p>Now let’s try to estimate SigmaK for a non identifiable pattern:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/EDMAinR/man/edma_fit.html">edma_fit</a></span>(sim)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">o &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/EDMAinR/man/SigmaK_fit.html">SigmaK_fit</a></span>(fit, m)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">o</a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="co">#&gt; EDMA parametric fit: Simulated landmark data</span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="co">#&gt; Call: SigmaK_fit(object = fit, pattern = m)</span></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="co">#&gt; 2 dimensions, 4 landmarks, 500 replicates, no bootstrap</span></a></code></pre></div>
<p>The estimates are pretty far off from the true values:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="dt">true=</span>parm, <span class="dt">est=</span>o<span class="op">$</span>results<span class="op">$</span>par)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co">#&gt;   true       est</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="co">#&gt; a 0.25 0.2871702</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="co">#&gt; b 0.07 0.1096243</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/pkg/EDMAinR/man/SigmaK_fit.html">SigmaK</a></span>(o)</a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="co">#&gt;           L1        L2        L3        L4</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="co">#&gt; L1 0.2871702 0.1096243 0.1096243 0.1096243</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="co">#&gt; L2 0.1096243 0.2871702 0.1096243 0.1096243</span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="co">#&gt; L3 0.1096243 0.1096243 0.2871702 0.1096243</span></a>
<a class="sourceLine" id="cb16-10" data-line-number="10"><span class="co">#&gt; L4 0.1096243 0.1096243 0.1096243 0.2871702</span></a></code></pre></div>
<p>If we now do the sensitivity analysis, we see all kinds of estimates while all leading to the same loss function value. This a clear indication of non-estimability:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">s &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/EDMAinR/man/SigmaK_fit.html">sensitivity</a></span>(o)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">s</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="co">#&gt;           par_a       par_b        value</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="co">#&gt;  [1,] 0.2871702  0.10962428 0.0003358588</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="co">#&gt;  [2,] 0.4668093  0.28925612 0.0003358596</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="co">#&gt;  [3,] 0.1430023 -0.03452708 0.0003358583</span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="co">#&gt;  [4,] 0.1883117  0.01077916 0.0003358582</span></a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="co">#&gt;  [5,] 0.1958401  0.01830934 0.0003358582</span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="co">#&gt;  [6,] 0.1949330  0.01739788 0.0003358583</span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="co">#&gt;  [7,] 0.1184738 -0.05903101 0.0003358604</span></a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="co">#&gt;  [8,] 0.2589918  0.08146353 0.0003358583</span></a>
<a class="sourceLine" id="cb17-12" data-line-number="12"><span class="co">#&gt;  [9,] 0.3590700  0.18152654 0.0003358586</span></a>
<a class="sourceLine" id="cb17-13" data-line-number="13"><span class="co">#&gt; [10,] 0.1187325 -0.05879193 0.0003358584</span></a>
<a class="sourceLine" id="cb17-14" data-line-number="14"><span class="co">#&gt; [11,] 0.5828245  0.40531593 0.0003358599</span></a>
<a class="sourceLine" id="cb17-15" data-line-number="15"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(s)</a>
<a class="sourceLine" id="cb17-16" data-line-number="16"><span class="co">#&gt;      par_a            par_b              value          </span></a>
<a class="sourceLine" id="cb17-17" data-line-number="17"><span class="co">#&gt;  Min.   :0.1185   Min.   :-0.05903   Min.   :0.0003359  </span></a>
<a class="sourceLine" id="cb17-18" data-line-number="18"><span class="co">#&gt;  1st Qu.:0.1657   1st Qu.:-0.01187   1st Qu.:0.0003359  </span></a>
<a class="sourceLine" id="cb17-19" data-line-number="19"><span class="co">#&gt;  Median :0.1958   Median : 0.01831   Median :0.0003359  </span></a>
<a class="sourceLine" id="cb17-20" data-line-number="20"><span class="co">#&gt;  Mean   :0.2649   Mean   : 0.08739   Mean   :0.0003359  </span></a>
<a class="sourceLine" id="cb17-21" data-line-number="21"><span class="co">#&gt;  3rd Qu.:0.3231   3rd Qu.: 0.14558   3rd Qu.:0.0003359  </span></a>
<a class="sourceLine" id="cb17-22" data-line-number="22"><span class="co">#&gt;  Max.   :0.5828   Max.   : 0.40532   Max.   :0.0003359</span></a>
<a class="sourceLine" id="cb17-23" data-line-number="23"><span class="kw"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(s)</a></code></pre></div>
<p><img src="edma03-parametric_files/figure-html/unnamed-chunk-17-1.png" width="576"></p>
</div>
<div id="summary" class="section level2">
<h2 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h2>
<p>Parametric estimation of SigmaK involves the following steps:</p>
<ol style="list-style-type: decimal">
<li>non-parametric estimation of mean form and SigmaKstar using the <code>edma_fit</code> function,</li>
<li>constructing of a pattern matrix based on biology of landmarks and respecting statistical constraints,</li>
<li>use the <code>SigmaK_fit</code> to estimate SigmaK using the non-parametric fit and the pattern matrix,</li>
<li>make sure the results are estimable by running <code>sensitivity</code> analysis.</li>
</ol>
</div>
<div id="more-examples" class="section level2">
<h2 class="hasAnchor">
<a href="#more-examples" class="anchor"></a>More examples</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">parm &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">a=</span><span class="fl">0.25</span>, <span class="dt">b=</span><span class="fl">0.07</span>, <span class="dt">c=</span><span class="fl">0.1</span>, <span class="dt">d=</span><span class="fl">0.15</span>)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">m &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">    <span class="st">"a"</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">    <span class="ot">NA</span>, <span class="st">"b"</span>, <span class="ot">NA</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb18-5" data-line-number="5">    <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"c"</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb18-6" data-line-number="6">    <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"d"</span></a>
<a class="sourceLine" id="cb18-7" data-line-number="7">), <span class="dv">4</span>, <span class="dv">4</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb18-8" data-line-number="8"></a>
<a class="sourceLine" id="cb18-9" data-line-number="9">parm &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">a=</span><span class="fl">0.25</span>)</a>
<a class="sourceLine" id="cb18-10" data-line-number="10">m &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</a>
<a class="sourceLine" id="cb18-11" data-line-number="11">    <span class="st">"a"</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb18-12" data-line-number="12">    <span class="ot">NA</span>, <span class="st">"a"</span>, <span class="ot">NA</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb18-13" data-line-number="13">    <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"a"</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb18-14" data-line-number="14">    <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"a"</span></a>
<a class="sourceLine" id="cb18-15" data-line-number="15">), <span class="dv">4</span>, <span class="dv">4</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb18-16" data-line-number="16"></a>
<a class="sourceLine" id="cb18-17" data-line-number="17">parm &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">a=</span><span class="fl">0.25</span>, <span class="dt">b=</span><span class="fl">0.01</span>, <span class="dt">c=</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb18-18" data-line-number="18">m &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</a>
<a class="sourceLine" id="cb18-19" data-line-number="19">    <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="ot">NA</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb18-20" data-line-number="20">    <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="ot">NA</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb18-21" data-line-number="21">    <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"c"</span>, <span class="st">"b"</span>,</a>
<a class="sourceLine" id="cb18-22" data-line-number="22">    <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"b"</span>, <span class="st">"c"</span></a>
<a class="sourceLine" id="cb18-23" data-line-number="23">), <span class="dv">4</span>, <span class="dv">4</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb18-24" data-line-number="24"></a>
<a class="sourceLine" id="cb18-25" data-line-number="25">parm &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">a=</span><span class="fl">0.25</span>, <span class="dt">b=</span><span class="fl">0.07</span>)</a>
<a class="sourceLine" id="cb18-26" data-line-number="26">m &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</a>
<a class="sourceLine" id="cb18-27" data-line-number="27">    <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"b"</span>,</a>
<a class="sourceLine" id="cb18-28" data-line-number="28">    <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"b"</span>,</a>
<a class="sourceLine" id="cb18-29" data-line-number="29">    <span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>,</a>
<a class="sourceLine" id="cb18-30" data-line-number="30">    <span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"a"</span></a>
<a class="sourceLine" id="cb18-31" data-line-number="31">), <span class="dv">4</span>, <span class="dv">4</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb18-32" data-line-number="32"></a>
<a class="sourceLine" id="cb18-33" data-line-number="33">SigmaK &lt;-<span class="st"> </span>EDMAinR<span class="op">:::</span><span class="kw">.vec2mat</span>(parm, EDMAinR<span class="op">:::</span><span class="kw">.mat2fac</span>(m))</a>
<a class="sourceLine" id="cb18-34" data-line-number="34">SigmaK</a>
<a class="sourceLine" id="cb18-35" data-line-number="35"><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></a>
<a class="sourceLine" id="cb18-36" data-line-number="36"><span class="co">#&gt; [1,] 0.25 0.07 0.07 0.07</span></a>
<a class="sourceLine" id="cb18-37" data-line-number="37"><span class="co">#&gt; [2,] 0.07 0.25 0.07 0.07</span></a>
<a class="sourceLine" id="cb18-38" data-line-number="38"><span class="co">#&gt; [3,] 0.07 0.07 0.25 0.07</span></a>
<a class="sourceLine" id="cb18-39" data-line-number="39"><span class="co">#&gt; [4,] 0.07 0.07 0.07 0.25</span></a>
<a class="sourceLine" id="cb18-40" data-line-number="40">sim &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/EDMAinR/man/edma_data.html">edma_simulate_data</a></span>(<span class="dt">n=</span><span class="dv">500</span>, M, SigmaK)</a>
<a class="sourceLine" id="cb18-41" data-line-number="41"><span class="kw"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span>(M) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span>(sim<span class="op">$</span>data[[1L]])</a>
<a class="sourceLine" id="cb18-42" data-line-number="42"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(SigmaK) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(m) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(sim<span class="op">$</span>data[[1L]])</a>
<a class="sourceLine" id="cb18-43" data-line-number="43"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(SigmaK) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(m) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(sim<span class="op">$</span>data[[1L]])</a>
<a class="sourceLine" id="cb18-44" data-line-number="44">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/EDMAinR/man/edma_fit.html">edma_fit</a></span>(sim)</a>
<a class="sourceLine" id="cb18-45" data-line-number="45"><span class="kw"><a href="https://rdrr.io/r/base/try.html">try</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/EDMAinR/man/SigmaK_fit.html">SigmaK_fit</a></span>(fit, m))</a>
<a class="sourceLine" id="cb18-46" data-line-number="46"><span class="co">#&gt; EDMA parametric fit: Simulated landmark data</span></a>
<a class="sourceLine" id="cb18-47" data-line-number="47"><span class="co">#&gt; Call: SigmaK_fit(object = fit, pattern = m)</span></a>
<a class="sourceLine" id="cb18-48" data-line-number="48"><span class="co">#&gt; 2 dimensions, 4 landmarks, 500 replicates, no bootstrap</span></a>
<a class="sourceLine" id="cb18-49" data-line-number="49">o &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/EDMAinR/man/SigmaK_fit.html">SigmaK_fit</a></span>(fit, m, <span class="dt">method=</span><span class="st">"SANN"</span>)</a>
<a class="sourceLine" id="cb18-50" data-line-number="50"><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="dt">true=</span>parm, <span class="dt">est=</span>o<span class="op">$</span>results<span class="op">$</span>par)</a>
<a class="sourceLine" id="cb18-51" data-line-number="51"><span class="co">#&gt;   true       est</span></a>
<a class="sourceLine" id="cb18-52" data-line-number="52"><span class="co">#&gt; a 0.25 0.4574372</span></a>
<a class="sourceLine" id="cb18-53" data-line-number="53"><span class="co">#&gt; b 0.07 0.2670822</span></a>
<a class="sourceLine" id="cb18-54" data-line-number="54"><span class="kw"><a href="https://rdrr.io/pkg/EDMAinR/man/SigmaK_fit.html">SigmaK</a></span>(o)</a>
<a class="sourceLine" id="cb18-55" data-line-number="55"><span class="co">#&gt;           L1        L2        L3        L4</span></a>
<a class="sourceLine" id="cb18-56" data-line-number="56"><span class="co">#&gt; L1 0.4574372 0.2670822 0.2670822 0.2670822</span></a>
<a class="sourceLine" id="cb18-57" data-line-number="57"><span class="co">#&gt; L2 0.2670822 0.4574372 0.2670822 0.2670822</span></a>
<a class="sourceLine" id="cb18-58" data-line-number="58"><span class="co">#&gt; L3 0.2670822 0.2670822 0.4574372 0.2670822</span></a>
<a class="sourceLine" id="cb18-59" data-line-number="59"><span class="co">#&gt; L4 0.2670822 0.2670822 0.2670822 0.4574372</span></a>
<a class="sourceLine" id="cb18-60" data-line-number="60">s &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/EDMAinR/man/SigmaK_fit.html">sensitivity</a></span>(o)</a>
<a class="sourceLine" id="cb18-61" data-line-number="61">s</a>
<a class="sourceLine" id="cb18-62" data-line-number="62"><span class="co">#&gt;            par_a      par_b        value</span></a>
<a class="sourceLine" id="cb18-63" data-line-number="63"><span class="co">#&gt;  [1,]  0.4574372  0.2670822 0.0005072810</span></a>
<a class="sourceLine" id="cb18-64" data-line-number="64"><span class="co">#&gt;  [2,]  1.2330377  1.0426229 0.0005072637</span></a>
<a class="sourceLine" id="cb18-65" data-line-number="65"><span class="co">#&gt;  [3,]  1.1277835  0.9373566 0.0005072628</span></a>
<a class="sourceLine" id="cb18-66" data-line-number="66"><span class="co">#&gt;  [4,]  0.3960654  0.2055129 0.0005073055</span></a>
<a class="sourceLine" id="cb18-67" data-line-number="67"><span class="co">#&gt;  [5,]  1.7358208  1.5454196 0.0005072657</span></a>
<a class="sourceLine" id="cb18-68" data-line-number="68"><span class="co">#&gt;  [6,]  5.4261897  5.2355979 0.0005073383</span></a>
<a class="sourceLine" id="cb18-69" data-line-number="69"><span class="co">#&gt;  [7,]  5.2039384  5.0134294 0.0005072800</span></a>
<a class="sourceLine" id="cb18-70" data-line-number="70"><span class="co">#&gt;  [8,] 11.2759342 11.0855068 0.0005072628</span></a>
<a class="sourceLine" id="cb18-71" data-line-number="71"><span class="co">#&gt;  [9,]  5.0071493  4.8166630 0.0005072712</span></a>
<a class="sourceLine" id="cb18-72" data-line-number="72"><span class="co">#&gt; [10,]  2.9753813  2.7850310 0.0005072832</span></a>
<a class="sourceLine" id="cb18-73" data-line-number="73"><span class="co">#&gt; [11,]  2.3966328  2.2061435 0.0005072722</span></a>
<a class="sourceLine" id="cb18-74" data-line-number="74"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(s)</a>
<a class="sourceLine" id="cb18-75" data-line-number="75"><span class="co">#&gt;      par_a             par_b             value          </span></a>
<a class="sourceLine" id="cb18-76" data-line-number="76"><span class="co">#&gt;  Min.   : 0.3961   Min.   : 0.2055   Min.   :0.0005073  </span></a>
<a class="sourceLine" id="cb18-77" data-line-number="77"><span class="co">#&gt;  1st Qu.: 1.1804   1st Qu.: 0.9900   1st Qu.:0.0005073  </span></a>
<a class="sourceLine" id="cb18-78" data-line-number="78"><span class="co">#&gt;  Median : 2.3966   Median : 2.2061   Median :0.0005073  </span></a>
<a class="sourceLine" id="cb18-79" data-line-number="79"><span class="co">#&gt;  Mean   : 3.3850   Mean   : 3.1946   Mean   :0.0005073  </span></a>
<a class="sourceLine" id="cb18-80" data-line-number="80"><span class="co">#&gt;  3rd Qu.: 5.1055   3rd Qu.: 4.9150   3rd Qu.:0.0005073  </span></a>
<a class="sourceLine" id="cb18-81" data-line-number="81"><span class="co">#&gt;  Max.   :11.2759   Max.   :11.0855   Max.   :0.0005073</span></a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#pattern-matrix">Pattern matrix</a></li>
      <li><a href="#simulated-example">Simulated example</a></li>
      <li><a href="#parametric-estimation">Parametric estimation</a></li>
      <li><a href="#sensitivity-analysis">Sensitivity analysis</a></li>
      <li><a href="#non-estimability">Non-estimability</a></li>
      <li><a href="#summary">Summary</a></li>
      <li><a href="#more-examples">More examples</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Peter Solymos, Subhash R. Lele, Theodore M. Cole, Liangyuan Hu, Joan T. Richtsmeier.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
