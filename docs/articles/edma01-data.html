<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="EDMAinR">
<title>EDMA data • EDMAinR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="EDMA data">
<meta property="og:description" content="EDMAinR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script src="https://cdn.usefathom.com/script.js" data-site="KTMJHUPR" defer></script><link rel="icon" href="https://peter.solymos.org/favicon.ico">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">EDMAinR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3-0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/edma01-data.html">EDMA data</a>
    <a class="dropdown-item" href="../articles/edma02-form.html">EDMA form matrix</a>
    <a class="dropdown-item" href="../articles/edma03-form-difference.html">EDMA form difference matrix</a>
    <a class="dropdown-item" href="../articles/edma04-growth.html">EDMA growth matrix</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="http://twitter.com/psolymos" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="http://github.com/psolymos" aria-label="GitHub">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>EDMA data</h1>
                        <h4 data-toc-skip class="author">Peter
Solymos</h4>
            
      
      
      <div class="d-none name"><code>edma01-data.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><strong>EDMAinR</strong> is an R package for Euclidean Distance
Matrix Analysis (EDMA). EDMA is a coordinate‐free approach for comparing
biological shapes using landmark data.</p>
<p>You can install the package from GitHub as with the help of the
<strong>remotes</strong> R package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">EDMAinR</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://remotes.r-lib.org" class="external-link">remotes</a></span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span>  <span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"psolymos/EDMAinR"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>You can now load the <strong>EDMAinR</strong> package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">EDMAinR</span><span class="op">)</span></span>
<span><span class="co">#&gt; EDMAinR 0.3-0     2023-08-21</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="landmark-data">Landmark data<a class="anchor" aria-label="anchor" href="#landmark-data"></a>
</h2>
<div class="section level3">
<h3 id="reading-data-from-xyz-files">Reading data from xyz files<a class="anchor" aria-label="anchor" href="#reading-data-from-xyz-files"></a>
</h3>
<p>Use the <code>read_xyz</code> function to read 2D or 3D landmark data
from <code>*.xyz</code> files. First we specify the paths to the xyz
file:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/crouzon/Crouzon_P0_Global_MUT.xyz"</span>, </span>
<span>    package<span class="op">=</span><span class="st">"EDMAinR"</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p><em>Note</em>: we use the <code><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file()</a></code> function to
access example files from the package. When defining your own files, you
will either set the working directory using <code><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd()</a></code> or use
a path like
<code>file &lt;- "c:/Users/&lt;user&gt;/&lt;etc&gt;"</code>.</p>
</blockquote>
<p>The xyz landmark data has the following structure:</p>
<ul>
<li>Header: this is the description of the data.</li>
<li>
<code>XYZ</code>: indicates dimensions, XYZ means 3D landmark
data.</li>
<li>
<code>42L 3 9</code>: dimensions, e.g. 42 landmarks (<span class="math inline">\(K\)</span>), 3 dimensions (<span class="math inline">\(D\)</span>), 9 specimens (<span class="math inline">\(n\)</span>).</li>
<li>Landmark names, separated by space.</li>
<li>The stacked data of landmark coordinates, e.g. 3 columns, space
separated numeric values with <span class="math inline">\(K \times
n\)</span> rows, the <span class="math inline">\(K\)</span> landmarks
per individuals stacked <span class="math inline">\(n\)</span>
times.</li>
<li>Blank line.</li>
<li>Date on of scans for each specimen (<span class="math inline">\(n\)</span> rows), this part is also used to get
specimen IDs.</li>
</ul>
<p>Now we can read in these text files:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/edma_data.html">read_xyz</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p><em>Note</em>: find more information <a href="#turning-3d-arrays-into-edma-data-objects">below</a> about reading
in other morphometrics file formats.</p>
</blockquote>
<p>We stored the data from the file in the object called <code>x</code>.
By typing the name <code>x</code> (or by typing <code>print(x)</code>)
we get to see what is inside:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span></span>
<span><span class="co">#&gt; EDMA data: Crouzon P0 MUT</span></span>
<span><span class="co">#&gt; 47 landmarks, 3 dimensions, 28 specimens</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-edma-data-format">The EDMA data format<a class="anchor" aria-label="anchor" href="#the-edma-data-format"></a>
</h3>
<p>The printout of <code>x</code> told us the most important facts about
the data: the header information and the dimensions.</p>
<p>The EDMA data object (class ‘edma_data’) is a list with two
elements:</p>
<ul>
<li>
<code>$name</code> is the data set name (header information from the
<code>.xyz</code> file),</li>
<li>
<code>$data</code> is a list of <span class="math inline">\(n\)</span> matrices (the list can be named if
specimen information is present), each matrix is of dimension <span class="math inline">\(K \times D\)</span>, dimension names for the
matrices describing landmark names (rows) and coordinate names
(columns).</li>
</ul>
</div>
<div class="section level3">
<h3 id="edma-data-dimensions-and-names">EDMA data dimensions and names<a class="anchor" aria-label="anchor" href="#edma-data-dimensions-and-names"></a>
</h3>
<p>The following methods are used to retrieve useful information from
EDMA data objects.</p>
<p>Use <code>dim</code> to access dimensions (landmarks, <span class="math inline">\(K\)</span>; dimensions, <span class="math inline">\(D\)</span>; replicates, <span class="math inline">\(n\)</span>). <code>landmarks</code>,
<code>dimensions</code>, and <code>specimens</code> return the landmark,
dimension, and specimen names, respectively, <code>dimnames</code>
returns all three in a list:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># dimensions</span></span>
<span><span class="co">#&gt; [1] 47  3 28</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># dimension names</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;  [1] "amsph" "bas"   "cpsh"  "ethma" "ethmp" "laalf" "lasph" "lflac" "lnsla"</span></span>
<span><span class="co">#&gt; [10] "lnslp" "locc"  "loci"  "lpalf" "lpfl"  "lpmx"  "lpns"  "lpsh"  "lpsq" </span></span>
<span><span class="co">#&gt; [19] "lpto"  "lptyp" "lsqu"  "lsyn"  "lzya"  "lzygo" "lzyt"  "opi"   "raalf"</span></span>
<span><span class="co">#&gt; [28] "rasph" "rflac" "rmaxi" "rnsla" "rnslp" "rocc"  "roci"  "rpalf" "rpfl" </span></span>
<span><span class="co">#&gt; [37] "rpmx"  "rpns"  "rpsh"  "rpsq"  "rpto"  "rptyp" "rsqu"  "rsyn"  "rzya" </span></span>
<span><span class="co">#&gt; [46] "rzygo" "rzyt" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] "X" "Y" "Z"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt;  [1] "CZCD1_1"  "CZCD1_2"  "CZCD1_7"  "CZCD1_10" "CZCD1_11" "CZCD1_15"</span></span>
<span><span class="co">#&gt;  [7] "CZCD1_16" "CZCD1_18" "CZCD1_20" "CZCD1_21" "CZCD1_23" "CZCD1_24"</span></span>
<span><span class="co">#&gt; [13] "CZCD1_25" "CZCD1_28" "CZCD1_30" "CZCD1_32" "CZCD1_36" "CZCD1_37"</span></span>
<span><span class="co">#&gt; [19] "CZCD1_39" "CZCD1_40" "CZCD1_42" "CZCD1_53" "CZCD1_56" "CZCD1_59"</span></span>
<span><span class="co">#&gt; [25] "CZCD1_65" "CZCD1_66" "CZCD1_72" "CZCD1_73"</span></span>
<span><span class="fu"><a href="../reference/edma_data.html">landmarks</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># landmark names</span></span>
<span><span class="co">#&gt;  [1] "amsph" "bas"   "cpsh"  "ethma" "ethmp" "laalf" "lasph" "lflac" "lnsla"</span></span>
<span><span class="co">#&gt; [10] "lnslp" "locc"  "loci"  "lpalf" "lpfl"  "lpmx"  "lpns"  "lpsh"  "lpsq" </span></span>
<span><span class="co">#&gt; [19] "lpto"  "lptyp" "lsqu"  "lsyn"  "lzya"  "lzygo" "lzyt"  "opi"   "raalf"</span></span>
<span><span class="co">#&gt; [28] "rasph" "rflac" "rmaxi" "rnsla" "rnslp" "rocc"  "roci"  "rpalf" "rpfl" </span></span>
<span><span class="co">#&gt; [37] "rpmx"  "rpns"  "rpsh"  "rpsq"  "rpto"  "rptyp" "rsqu"  "rsyn"  "rzya" </span></span>
<span><span class="co">#&gt; [46] "rzygo" "rzyt"</span></span>
<span><span class="fu"><a href="../reference/edma_data.html">dimensions</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># the names of the coordinate dimensions</span></span>
<span><span class="co">#&gt; [1] "X" "Y" "Z"</span></span>
<span><span class="fu"><a href="../reference/edma_data.html">specimens</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># specimen IDs</span></span>
<span><span class="co">#&gt;  [1] "CZCD1_1"  "CZCD1_2"  "CZCD1_7"  "CZCD1_10" "CZCD1_11" "CZCD1_15"</span></span>
<span><span class="co">#&gt;  [7] "CZCD1_16" "CZCD1_18" "CZCD1_20" "CZCD1_21" "CZCD1_23" "CZCD1_24"</span></span>
<span><span class="co">#&gt; [13] "CZCD1_25" "CZCD1_28" "CZCD1_30" "CZCD1_32" "CZCD1_36" "CZCD1_37"</span></span>
<span><span class="co">#&gt; [19] "CZCD1_39" "CZCD1_40" "CZCD1_42" "CZCD1_53" "CZCD1_56" "CZCD1_59"</span></span>
<span><span class="co">#&gt; [25] "CZCD1_65" "CZCD1_66" "CZCD1_72" "CZCD1_73"</span></span></code></pre></div>
<p>When the dimension names are missing from the input data file, we use
<code>L</code> to denote landmarks and <code>S</code> to denote
specimens. These are prepended to numeric landmark and specimen IDs that
follows the original ordering of the data. The coordinate dimensions are
<code>"X"</code>, <code>"Y"</code>, and optionally <code>"Z"</code> for
3D landmark data.</p>
<p>It is also possible to manipulate dimension names. This is useful
when different files have the same landmarks with slight differences
(lower/upper case differences, etc.):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/edma_data.html">landmarks</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># copy original names</span></span>
<span><span class="fu"><a href="../reference/edma_data.html">landmarks</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">lm</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/edma_data.html">landmarks</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># new landmark names</span></span>
<span><span class="co">#&gt;  [1] "AMSPH" "BAS"   "CPSH"  "ETHMA" "ETHMP" "LAALF" "LASPH" "LFLAC" "LNSLA"</span></span>
<span><span class="co">#&gt; [10] "LNSLP" "LOCC"  "LOCI"  "LPALF" "LPFL"  "LPMX"  "LPNS"  "LPSH"  "LPSQ" </span></span>
<span><span class="co">#&gt; [19] "LPTO"  "LPTYP" "LSQU"  "LSYN"  "LZYA"  "LZYGO" "LZYT"  "OPI"   "RAALF"</span></span>
<span><span class="co">#&gt; [28] "RASPH" "RFLAC" "RMAXI" "RNSLA" "RNSLP" "ROCC"  "ROCI"  "RPALF" "RPFL" </span></span>
<span><span class="co">#&gt; [37] "RPMX"  "RPNS"  "RPSH"  "RPSQ"  "RPTO"  "RPTYP" "RSQU"  "RSYN"  "RZYA" </span></span>
<span><span class="co">#&gt; [46] "RZYGO" "RZYT"</span></span>
<span><span class="fu"><a href="../reference/edma_data.html">landmarks</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">lm</span> <span class="co"># reset names to original</span></span></code></pre></div>
<p>You can use the <code><a href="../reference/edma_scale.html">edma_scale()</a></code> function on the EDMA data
objects that implements various landmark scaling procedures.</p>
</div>
<div class="section level3">
<h3 id="selecting-subsets-of-edma-data-objects">Selecting subsets of EDMA data objects<a class="anchor" aria-label="anchor" href="#selecting-subsets-of-edma-data-objects"></a>
</h3>
<p>Subsetting the data comes handy sometimes, i.e. we might want to
select only a few of the landmarks to get a simplified picture of the
relationships, or because different input files list different landmarks
and we want to select the ones that are present in both data set. Or we
need to filter some specimens, because we want to select only specimens
of certain ages, gender, etc. Often we need to draw a random sample of
the specimens (for randomization and bootstrap).</p>
<p>The most general way to subset the data sets is <em>via</em> the
<code>[</code> function (i.e. <code>x[i, j, k]</code>), the 3 indices
inside the brackets refer to the landmarks (<code>i</code>), dimensions
(<code>j</code>), and specimens (<code>k</code>). Imagine the data as a
3D data cube and the square brackets allow us to slice the cube from 3
different directions. The colon notation in the next part mean what
parts should be taken using the <code>from:to</code> way of defining a
sequence of integers:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, , <span class="op">]</span>  <span class="co"># select the 1st 10 landmarks</span></span>
<span><span class="co">#&gt; EDMA data: Crouzon P0 MUT</span></span>
<span><span class="co">#&gt; 10 landmarks, 3 dimensions, 28 specimens</span></span>
<span><span class="va">x</span><span class="op">[</span> , <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="op">]</span>  <span class="co"># select 2 of the 2 dimensions</span></span>
<span><span class="co">#&gt; EDMA data: Crouzon P0 MUT</span></span>
<span><span class="co">#&gt; 47 landmarks, 2 dimensions, 28 specimens</span></span>
<span><span class="va">x</span><span class="op">[</span> , , <span class="fl">11</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span> <span class="co"># select individuals from 11 to 20</span></span>
<span><span class="co">#&gt; EDMA data: Crouzon P0 MUT</span></span>
<span><span class="co">#&gt; 47 landmarks, 3 dimensions, 10 specimens</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, , <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span> <span class="co"># combine multiple indices</span></span>
<span><span class="co">#&gt; EDMA data: Crouzon P0 MUT</span></span>
<span><span class="co">#&gt; 10 landmarks, 3 dimensions, 20 specimens</span></span></code></pre></div>
<p>Read more about how to use square brackets to extract parts of the
data object: <code><a href="https://rdrr.io/r/base/Extract.html" class="external-link">?Extract</a></code> (see section ‘Matrices and arrays’).
The most important thing to keep in mind is that the empty/missing index
(e.g. <code>x[,,]</code>) means ‘select everything’.</p>
<p>We can take subsets using:</p>
<ul>
<li>numeric indices (like as we saw above),</li>
<li>logical indices,</li>
<li>and by character names.</li>
</ul>
<p>Logical indices might be handy if, e.g., we have ancillary data about
the specimens. If we have <code>age</code> of each specimens (values in
ages matching the order of specimens in the EDMA data object), we can
use it as <code>x[,,age &lt; 1]</code>.</p>
<p>Character based subsets are useful if we want to select homologous
landmarks for multiple objects, or we want to make sure that the
landmarks’ order is identical among multiple objects. The same
<code>[</code> function can be used not only to take a subset but also
to reorder landmarks or specimens. Character indices are most suitable
for this purpose, e.g.:</p>
<pre class="lms"><code><span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"amsph"</span>, <span class="st">"bas"</span>, <span class="st">"cpsh"</span><span class="op">)</span>, , <span class="op">]</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="coercing-edma-data-into-other-object-types">Coercing EDMA data into other object types<a class="anchor" aria-label="anchor" href="#coercing-edma-data-into-other-object-types"></a>
</h3>
<p>The data (<code>$data</code>) format inside the object <code>x</code>
is list of the <span class="math inline">\(K \times D\)</span> matrices,
one for each individual. Sometimes it is handy to stack these matrices
and create a rectangular data (either as a matrix, or data frame, with
<span class="math inline">\(n \times K\)</span> rows and <span class="math inline">\(D\)</span> columns):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  num [1:1316, 1:3] 5.85 2.79 6.86 9.11 8.25 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   ..$ : chr [1:1316] "CZCD1_1_amsph" "CZCD1_1_bas" "CZCD1_1_cpsh" "CZCD1_1_ethma" ...</span></span>
<span><span class="co">#&gt;   ..$ : chr [1:3] "X" "Y" "Z"</span></span></code></pre></div>
<blockquote>
<p><em>Note</em>: we are using <code>str</code> to show the structure of
these objects, this is not necessary when exploring the data.
<code>str</code> here tells us the dimensions (1316 rows and 3 columns,
the first few values, and the dimension names).</p>
</blockquote>
<p>Alternatively, we can store the data as an array (<span class="math inline">\(K \times D \times n\)</span>):</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">as.array</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  num [1:47, 1:3, 1:28] 5.85 2.79 6.86 9.11 8.25 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "dimnames")=List of 3</span></span>
<span><span class="co">#&gt;   ..$ : chr [1:47] "amsph" "bas" "cpsh" "ethma" ...</span></span>
<span><span class="co">#&gt;   ..$ : chr [1:3] "X" "Y" "Z"</span></span>
<span><span class="co">#&gt;   ..$ : chr [1:28] "CZCD1_1" "CZCD1_2" "CZCD1_7" "CZCD1_10" ...</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="turning-3d-arrays-into-edma-data-objects">Turning 3D arrays into EDMA data objects<a class="anchor" aria-label="anchor" href="#turning-3d-arrays-into-edma-data-objects"></a>
</h3>
<p>The <code>as.edma_data</code> function turns a 3D array to an EDMA
data object. This is useful when handling 3D array objects returned by
many functions of the <a href="https://cran.r-project.org/package=geomorph" class="external-link"><strong>geomorph</strong></a>
package (i.e. after reading Morphologika, NTS, TPS files).</p>
<p>The header information gets lost in this way, but we can set it quite
easily:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xnew</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/edma_data.html">as.edma_data</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">as.array</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">xnew</span></span>
<span><span class="co">#&gt; EDMA data: Landmark data</span></span>
<span><span class="co">#&gt; 47 landmarks, 3 dimensions, 28 specimens</span></span>
<span><span class="va">xnew</span><span class="op">$</span><span class="va">name</span> <span class="op">&lt;-</span> <span class="st">"This is the same data as before"</span></span>
<span><span class="va">xnew</span></span>
<span><span class="co">#&gt; EDMA data: This is the same data as before</span></span>
<span><span class="co">#&gt; 47 landmarks, 3 dimensions, 28 specimens</span></span></code></pre></div>
<blockquote>
<p><em>Note</em>: the <strong>geomorph</strong> package needs to be
installed separately using
<code>install.packages("geomorph")</code>.</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="visual-inspection-of-the-data">Visual inspection of the data<a class="anchor" aria-label="anchor" href="#visual-inspection-of-the-data"></a>
</h2>
<p>The <code>plot_2d</code> function shows the convex hulls or
confidence ellipses for the landmarks based on all the specimens. The
plot is showing the first two axes of multidimensional scaling based on
the form matrices (<span class="math inline">\(FM\)</span>; pairwise
Euclidean distances):</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/edma_data.html">plot_2d</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p><img src="edma01-data_files/figure-html/allspec-1.png" width="700"></p>
<p>The images by default show the convex hull for each landmark
enclosing all specimens. It is also possible to use 95% confidence
ellipses:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/edma_data.html">plot_2d</a></span><span class="op">(</span><span class="va">x</span>, hull<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="edma01-data_files/figure-html/allspec2-1.png" width="700"></p>
<div class="section level3">
<h3 id="spotting-data-errors">Spotting data errors<a class="anchor" aria-label="anchor" href="#spotting-data-errors"></a>
</h3>
<p>Data sets can be checked using the <code>plot</code> function. By
default, this function steps through all the specimens to check for any
surprises. The blue areas show the convex hull for the landmark leaving
a single specimen out, while red dots show the actual specimen. It is a
sign of problem when a dot for a specimen is located far outside of the
convex hull.</p>
<p>Using the <code>which</code> argument we can specify which specimen
we want to display (it is not possible to select multiple specimen, use
the <code>[</code> method to take a subset of the data that and plot it
with <code>plot_2d</code>):</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, which<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="edma01-data_files/figure-html/onespec-1.png" width="700"></p>
<p>We will insert an error to show how the <code>plot</code> function
can help identify problems. We change the coordinates for the 1st
landmark of the 1st specimen. The error is showing up as an outlier
(long red line):</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## original values for specimen 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, which<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">## we change the 1st landmark</span></span>
<span><span class="va">xwrong</span> <span class="op">&lt;-</span> <span class="va">x</span></span>
<span><span class="va">xwrong</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xwrong</span>, which<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="edma01-data_files/figure-html/unnamed-chunk-2-1.png" width="45%"><img src="edma01-data_files/figure-html/unnamed-chunk-2-2.png" width="45%"></p>
</div>
<div class="section level3">
<h3 id="ordination-and-clustering">Ordination and clustering<a class="anchor" aria-label="anchor" href="#ordination-and-clustering"></a>
</h3>
<p>The ordination plot shows the specimens based on multidimensional
scaling using pairwise distances between specimens. These distances are
based on the T-statistic and can be calculated as
<code>as.dist(x)</code>. The calculation involves the following
steps:</p>
<ul>
<li>calculate Euclidean distances (<span class="math inline">\(ED_{i}\)</span>) between all pairs of landmarks
for specimen <span class="math inline">\(i\)</span> (<span class="math inline">\(i = 1, \dots, n\)</span>) based on the
coordinates,</li>
<li>calculate Euclidean distances (<span class="math inline">\(ED_{j}\)</span>) between all pairs of landmarks
for specimen <span class="math inline">\(j\)</span> (<span class="math inline">\(j = 1, \dots, n\)</span>) based on the
coordinates,</li>
<li>calculate the ratio <span class="math inline">\(ED_{i} /
ED_{j}\)</span>,</li>
<li>calculate the T-statistic on the log scale (so that a max/min ratio
of 1, that is 0 distance, becomes log(1)=0): <span class="math inline">\(d_{ij}=log(max[ED_{i} / ED_{j}] / min[ED_{i} /
ED_{j}])\)</span>.</li>
</ul>
<p>The multidimensional scaling uses the square root transformed log-T
distances.</p>
<p>The error shows up nicely in the ordination plot (colored red):</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/edma_data.html">plot_ord</a></span><span class="op">(</span><span class="va">x</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/edma_data.html">plot_ord</a></span><span class="op">(</span><span class="va">xwrong</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">xwrong</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="edma01-data_files/figure-html/unnamed-chunk-3-1.png" width="45%"><img src="edma01-data_files/figure-html/unnamed-chunk-3-2.png" width="45%"></p>
<p>The cluster dendrogram is based on the same log-T distance matrix
described above. The default agglomeration algorithm is set to the
Ward’s minimum variance method (<code>"ward.D2"</code>) which is using
the square root of the log-T distances too.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/edma_data.html">plot_clust</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/edma_data.html">plot_clust</a></span><span class="op">(</span><span class="va">xwrong</span><span class="op">)</span></span></code></pre></div>
<p><img src="edma01-data_files/figure-html/unnamed-chunk-4-1.png" width="45%"><img src="edma01-data_files/figure-html/unnamed-chunk-4-2.png" width="45%"></p>
<p>Other agglomeration methods can be set by passing a different
<code>method</code> argument, e.g. single linkage (see
<code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">?hclust</a></code> for a list of options):</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/edma_data.html">plot_clust</a></span><span class="op">(</span><span class="va">x</span>, method <span class="op">=</span> <span class="st">"single"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/edma_data.html">plot_clust</a></span><span class="op">(</span><span class="va">xwrong</span>, method <span class="op">=</span> <span class="st">"single"</span><span class="op">)</span></span></code></pre></div>
<p><img src="edma01-data_files/figure-html/unnamed-chunk-5-1.png" width="45%"><img src="edma01-data_files/figure-html/unnamed-chunk-5-2.png" width="45%"></p>
<p>Both the ordination and clustering functions return the
ordination/cluster results, so that plots can be further customized.
Here is an example to create a plot</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/edma_data.html">plot_ord</a></span><span class="op">(</span><span class="va">x</span>, plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">mds</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 5</span></span>
<span><span class="co">#&gt;  $ points: num [1:28, 1:2] -0.181 -0.757 -0.287 -0.116 -0.564 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:28] "CZCD1_1" "CZCD1_2" "CZCD1_7" "CZCD1_10" ...</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:2] "Axis 1" "Axis 2"</span></span>
<span><span class="co">#&gt;  $ eig   : NULL</span></span>
<span><span class="co">#&gt;  $ x     : NULL</span></span>
<span><span class="co">#&gt;  $ ac    : num 0.143</span></span>
<span><span class="co">#&gt;  $ GOF   : num [1:2] 0.253 0.253</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mds</span><span class="op">$</span><span class="va">points</span>, pch<span class="op">=</span><span class="fl">4</span>, col<span class="op">=</span><span class="st">"darkgreen"</span>,</span>
<span>  main<span class="op">=</span><span class="st">"Ordination diagram"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>, v<span class="op">=</span><span class="fl">0</span>, lty<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">mds</span><span class="op">$</span><span class="va">points</span>, labels<span class="op">=</span><span class="fu"><a href="../reference/edma_data.html">specimens</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, pos<span class="op">=</span><span class="fl">1</span>, cex<span class="op">=</span><span class="fl">0.6</span>, col<span class="op">=</span><span class="st">"tan"</span><span class="op">)</span></span></code></pre></div>
<p><img src="edma01-data_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p><a href="https://ggplot2-book.org/" class="external-link"><strong>ggplot2</strong></a> is a
popular alternative for R’s base graphics. Here is how to create plots
with it:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">mds</span><span class="op">$</span><span class="va">points</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">`Axis 1`</span>, y<span class="op">=</span><span class="va">`Axis 2`</span>, label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_label</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept<span class="op">=</span><span class="fl">0</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="edma01-data_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>See <code><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html" class="external-link">?ape::plot.phylo</a></code> for how to customize
dendrograms:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/edma_data.html">plot_clust</a></span><span class="op">(</span><span class="va">x</span>, plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">h</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; hclust(d = d, method = method)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cluster method   : ward.D2 </span></span>
<span><span class="co">#&gt; Number of objects: 28</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">h</span><span class="op">)</span></span></code></pre></div>
<p><img src="edma01-data_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/as.phylo.html" class="external-link">as.phylo</a></span><span class="op">(</span><span class="va">h</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"cladogram"</span>, font<span class="op">=</span><span class="fl">1</span>, cex<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span></span></code></pre></div>
<p><img src="edma01-data_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
<p><a href="https://CRAN.R-project.org/package=ggdendro" class="external-link"><strong>ggdendro</strong></a>
is a package that can plot tree-like data structures with
<strong>ggplot2</strong>. Here is an example:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/andrie/ggdendro" class="external-link">ggdendro</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggdendro/man/ggdendrogram.html" class="external-link">ggdendrogram</a></span><span class="op">(</span><span class="va">h</span>, rotate <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="edma01-data_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="writing-data-to-xyz-format">Writing data to xyz format<a class="anchor" aria-label="anchor" href="#writing-data-to-xyz-format"></a>
</h3>
<p>Different kinds of morphometrics data formats can be turned into EDMA
data format as long as it can be organized into a <span class="math inline">\(K \times D \times n\)</span> array and then using
the <code>as.edma_data</code> method.</p>
<p>Once the data is an EDMA data object, the <code>write_xyz</code>
function will write that into a text file with extension xyz:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".xyz"</span><span class="op">)</span> <span class="co"># create a temporary file</span></span>
<span><span class="fu"><a href="../reference/edma_data.html">write_xyz</a></span><span class="op">(</span><span class="va">x</span>, file<span class="op">=</span><span class="va">f</span><span class="op">)</span>            <span class="co"># write data to temp file</span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/edma_data.html">read_xyz</a></span><span class="op">(</span>file<span class="op">=</span><span class="va">f</span><span class="op">)</span>         <span class="co"># read back the data</span></span>
<span><span class="va">x</span>                               <span class="co"># original data</span></span>
<span><span class="co">#&gt; EDMA data: Crouzon P0 MUT</span></span>
<span><span class="co">#&gt; 47 landmarks, 3 dimensions, 28 specimens</span></span>
<span><span class="va">tmp</span>                             <span class="co"># this should be the same too</span></span>
<span><span class="co">#&gt; EDMA data: Crouzon P0 MUT</span></span>
<span><span class="co">#&gt; 47 landmarks, 3 dimensions, 28 specimens</span></span>
<span><span class="co">## test if the all the dimnames are the same</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span>                       <span class="co"># delete temp file</span></span></code></pre></div>
<blockquote>
<p><em>Note</em>: tuse a real file name and path, the temp file is used
here for demonstration purposes only.</p>
</blockquote>
<p>Read on to see how the xyz data are used to fit EDMA models to
it.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Peter Solymos, Subhash R. Lele, Theodore M. Cole, Liangyuan Hu, Joan T. Richtsmeier.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
