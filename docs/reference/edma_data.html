<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Functions for reading, simulating, and manipulating EDMA data."><title>Functions for EDMA data objects — edma_data • EDMAinR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Functions for EDMA data objects — edma_data"><meta property="og:description" content="Functions for reading, simulating, and manipulating EDMA data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-55877016-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-55877016-2');
</script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    <a class="navbar-brand me-2" href="../index.html">EDMAinR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2-0</small>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/edma01-data.html">EDMA data</a>
    <a class="dropdown-item" href="../articles/edma02-form.html">EDMA form matrix</a>
    <a class="dropdown-item" href="../articles/edma03-form-difference.html">EDMA form difference matrix</a>
    <a class="dropdown-item" href="../articles/edma04-growth.html">EDMA growth matrix</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>
  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
      <img src="" class="logo" alt=""><h1>Functions for EDMA data objects</h1>
      
      <div class="d-none name"><code>edma_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Functions for reading, simulating, and manipulating EDMA data.</p>
    </div>

    <div class="ref-usage section level2 sourceCode">
    <h2>Usage</h2>
    <pre><code>## read xyz files
read_xyz(file, ...)

## write xyz files
write_xyz(x, file)

## data generation
edma_simulate_data(n, M, SigmaK)

## print
# S3 method for edma_data
print(x, truncate=40, ...)

## accessors
# S3 method for edma_data
dim(x)
# S3 method for edma_data
dimnames(x)
landmarks(x, ...)
dimensions(x, ...)
specimens(x, ...)
# S3 method for edma_data
landmarks(x, ...)
# S3 method for edma_data
dimensions(x, ...)
# S3 method for edma_data
specimens(x, ...)
landmarks(x) &lt;- value
dimensions(x) &lt;- value
specimens(x) &lt;- value

## subsetting
# S3 method for edma_data
subset(x, subset, ...)
# S3 method for edma_data
[(x, i, j, k)

## coercion
# S3 method for edma_data
stack(x, ...)
# S3 method for edma_data
as.matrix(x, ...)
# S3 method for edma_data
as.data.frame(x, ...)
# S3 method for edma_data
as.array(x, ...)
as.edma_data(x, ...)
# S3 method for array
as.edma_data(x, ...)

combine_data(a, b,
    ga="G1", gb="G2")
combine_data4(a1, a2, b1, b2,
    ga1="A1", ga2="A2", gb1="B1", gb2="B2")

## plot methods
plot_2d(x, ...)
plot_ord(x, ...)
plot_clust(x, ...)
# S3 method for edma_data
plot(x, which=NULL,
    ask=dev.interactive(), ...)
# S3 method for edma_data
plot_2d(x, which=NULL, ...)
# S3 method for edma_data
plot_ord(x, ...)
# S3 method for edma_data
plot_clust(x, ...)

## dissimilarities
# S3 method for edma_data
as.dist(m, diag=FALSE, upper=FALSE)</code></pre>
    </div>

    <div id="ref-sections">
    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>file</dt>
<dd><p>the name of the file which the data are to be read from, or written to,
see <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></code> for more details.</p></dd>
<dt>x, m</dt>
<dd><p>an EDMA data object of class 'edma_data'.</p></dd>
<dt>which</dt>
<dd><p>if a subset of the specimens is required.</p></dd>
<dt>value</dt>
<dd><p>a possible value for <code>dimnames(x)</code>.</p></dd>
<dt>ask</dt>
<dd><p>logical, if <code>TRUE</code>, the user is asked before each plot.</p></dd>
<dt>subset, i, j, k</dt>
<dd><p>subset is for subsetting specimens (e.g. for bootstrap).
[i, j, k] indices refer to [landmarks, dimensions, specimens].</p></dd>
<dt>n, M, SigmaK</dt>
<dd><p>number of specimens (n), mean form matrix (M, K x D),
variance-covariance matrix (K x K symmetric).</p></dd>
<dt>truncate</dt>
<dd><p>numeric, number of characters to print for the object title.</p></dd>
<dt>diag, upper</dt>
<dd><p>logical, indicating whether the diagonal
and the upper triangle of the distance matrix should be printed.
See <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></code>.</p></dd>
<dt>a, b, a1, a2, b1, b2</dt>
<dd><p>EDMA data objects to be combined together. Landmarks must be
homologous (determined by dimension names).</p></dd>
<dt>ga, gb, ga1, ga2, gb1, gb2</dt>
<dd><p>character, group names that are prepended to the specimen names
to differentiate the groups.</p></dd>
<dt>...</dt>
<dd><p>other arguments passed to methods.
For <code>read_xyz</code>, arguments passed to <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></code>.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The xyz landmark data has the following structure, see Examples:</p>
<p>- Header: this is the description of the data.</p>
<p>- XYZ: indicates dimensions, XYZ means 3D landmark data.</p>
<p>- <code>42L 3 9</code>: dimensions, e.g. 42 landmarks (K), 3 dimensions (D), 9 specimens (n).</p>
<p>- Landmark names, separated by space.</p>
<p>- The stacked data of landmark coordinates, e.g. 3 columns,
space separated numeric values with K*n rows,
the K landmarks per individuals stacked n times.</p>
<p>- Blank line.</p>
<p>- Date on of scans for each specimen (n rows),
this part is also used to get specimen IDs.</p>
<p>After reading in or simulating and EDMA data object,
the methods help extracting info, or manipulate these objects.
See Values and Examples.</p>
<p>The EDMA data object (class 'edma_data') is a list with two
elements: <code>$name</code> is the data set name (header information from
the .xyz file), <code>$data</code> is a list of n matrices (the list can be
named if speciemen information is present),
each matrix is of dimension K x D, dimension names for the
matrices describing landmark names and coordinate names.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>edma_simulate_data</code> returns an EDMA data object of
class 'edma_data'.
The <code>dim</code> returns the number of landmarks (K), dimensions (D),
and specimens (n) in a data object.
<code>landmarks</code>, <code>dimensions</code>, and <code>specimens</code>are dimensions names, <code>dimnames</code> returns these as a list.
Landmark names and dimensions are used to check
if landmarks are homogeneous among objects.
It is possible to set the dimansion names as
<code>dimnames(x) &lt;- value</code> where <code>value</code> is the
new value for the name.
The <code>print</code> method prints info about the data object.
The methods <code>stack</code> and <code>as.matrix</code> return a stacked
2D array (K*n x D) with the landmark coordinates,
<code>as.data.frame</code> turns the same 2D stacked array into a data frame,
<code>as.array</code> returns a 3D array (K x D x n).
<code>as.edma_data</code> turns a 3D array to an EDMA data object,
this is useful to handle 3D array objects returned by many
functions of the geomorph package (i.e. after reding
Morphologika, NTS, TPS files).
<code>combine_data</code> and <code>combine_data4</code> combines
2 or 4 EDMA data sets together, landmarks must be homologous.
<code>as.dist</code> calculates the dissimilarity matrix (n x n, object
of class 'dist', see <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code>) containing
pairwise dissimilarities among the specimens.
Dissimilarity is based on the T-statistic (max/min distance)
averaged (so that it is symmetric) and on the log scale
(so that self dissimilarity is 0).
<code>subset</code> and <code>[i,j,k]</code> returns an EDMA data object
with the desired dimensions or permutations. See Examples.
<code>plot</code> and <code>plot_2d</code> produces a series of plots
as a side effect, returning the data object invisibly.
The functions provide diagnostics for each specimen
or just the specimen selected by the <code>which</code> argument.
The 2D projection is used in case of 3D landmark data.
The convex hull of the specimens (excluding the one being
selected) is compared with the actual specimen's landmarks.
This allows easy spotting of erroneous data.
The <code>plot_ord</code> and <code>plot_clust</code> are based on the
dissimilarities among specimens and provide ordination
(metric multidimensional scaling using <code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></code>based on square rooted dissimilarities and Cailliez's correction).
and hierarchical cluster dendrogram (using the <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></code>function with Ward's clustering method).</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Peter Solymos</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code>plot.edma_data</code> for visualizing EDMA data objects.</p>
<p><code><a href="edma_fit.html">edma_fit</a></code> for EDMA analysis.</p>
<p><code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code> for dissimilarity matrices and
<code><a href="edma_fdm.html">global_test</a></code> for description of the T-statistic.</p></div>
    </div>
    </div>

    <div id="examples">
    <h2>Examples</h2>
    <div class="ref-examples sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">## read xyz files</span></span>
<span class="r-in"><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span class="r-in">    <span class="st">"extdata/crouzon/Crouzon_P0_Global_MUT.xyz"</span>,</span>
<span class="r-in">    package<span class="op">=</span><span class="st">"EDMAinR"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">read_xyz</span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span>
<span class="r-in"><span class="va">x</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EDMA data: Crouzon P0 MUT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47 landmarks, 3 dimensions, 28 specimens</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## test writing xyz file</span></span>
<span class="r-in"><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".xyz"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">write_xyz</span><span class="op">(</span><span class="va">x</span>, file<span class="op">=</span><span class="va">f</span><span class="op">)</span></span>
<span class="r-in"><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu">read_xyz</span><span class="op">(</span>file<span class="op">=</span><span class="va">f</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## the orignal structure</span></span>
<span class="r-in"><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">l</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, sep<span class="op">=</span><span class="st">"\n"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Crouzon P0 MUT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> XYZ</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47L 3 28 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> amsph bas cpsh ethma ethmp laalf lasph lflac lnsla lnslp locc loci lpalf lpfl lpmx lpns lpsh lpsq lpto lptyp lsqu lsyn lzya lzygo lzyt opi raalf rasph rflac rmaxi rnsla rnslp rocc roci rpalf rpfl rpmx rpns rpsh rpsq rpto rptyp rsqu rsyn rzya rzygo rzyt </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.85485 5.98171 2.2017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.79418 6.2371 0.400282</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.85584 5.80958 3.3537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9.10866 5.82195 3.91282</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8.2508 5.81294 3.77622</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10.0935 6.17677 3.65059</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">l</span><span class="op">[</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">l</span><span class="op">)</span><span class="op">-</span><span class="fl">10</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">l</span><span class="op">)</span><span class="op">]</span>, sep<span class="op">=</span><span class="st">"\n"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CZCD1_37 Scanned on 010511</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CZCD1_39 Scanned on 010511</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CZCD1_40 Scanned on 010511</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CZCD1_42 Scanned on 010511</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CZCD1_53 Scanned on 122310</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CZCD1_56 Scanned on 122310</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CZCD1_59 Scanned on 122310</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CZCD1_65 Scanned on 010511</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CZCD1_66 Scanned on 010511</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CZCD1_72 Scanned on 010311</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CZCD1_73 Scanned on 010311</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## plots</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span> <span class="co"># steps through all individuals</span></span>
<span class="r-plt img"><img src="edma_data-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="edma_data-2.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="edma_data-3.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="edma_data-4.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="edma_data-5.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="edma_data-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu">plot_2d</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># all speciemns in 1 plot</span></span>
<span class="r-in"><span class="fu">plot_2d</span><span class="op">(</span><span class="va">x</span>, which<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="co"># show specimen #2</span></span>
<span class="r-plt img"><img src="edma_data-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu">plot_ord</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span class="r-plt img"><img src="edma_data-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu">plot_clust</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span class="r-plt img"><img src="edma_data-9.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## dimensions and names</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 47  3 28</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "amsph" "bas"   "cpsh"  "ethma" "ethmp" "laalf" "lasph" "lflac" "lnsla"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10] "lnslp" "locc"  "loci"  "lpalf" "lpfl"  "lpmx"  "lpns"  "lpsh"  "lpsq" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] "lpto"  "lptyp" "lsqu"  "lsyn"  "lzya"  "lzygo" "lzyt"  "opi"   "raalf"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28] "rasph" "rflac" "rmaxi" "rnsla" "rnslp" "rocc"  "roci"  "rpalf" "rpfl" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37] "rpmx"  "rpns"  "rpsh"  "rpsq"  "rpto"  "rptyp" "rsqu"  "rsyn"  "rzya" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [46] "rzygo" "rzyt" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "X" "Y" "Z"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "CZCD1_1"  "CZCD1_2"  "CZCD1_7"  "CZCD1_10" "CZCD1_11" "CZCD1_15"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] "CZCD1_16" "CZCD1_18" "CZCD1_20" "CZCD1_21" "CZCD1_23" "CZCD1_24"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] "CZCD1_25" "CZCD1_28" "CZCD1_30" "CZCD1_32" "CZCD1_36" "CZCD1_37"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] "CZCD1_39" "CZCD1_40" "CZCD1_42" "CZCD1_53" "CZCD1_56" "CZCD1_59"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] "CZCD1_65" "CZCD1_66" "CZCD1_72" "CZCD1_73"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu">landmarks</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "amsph" "bas"   "cpsh"  "ethma" "ethmp" "laalf" "lasph" "lflac" "lnsla"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10] "lnslp" "locc"  "loci"  "lpalf" "lpfl"  "lpmx"  "lpns"  "lpsh"  "lpsq" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] "lpto"  "lptyp" "lsqu"  "lsyn"  "lzya"  "lzygo" "lzyt"  "opi"   "raalf"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28] "rasph" "rflac" "rmaxi" "rnsla" "rnslp" "rocc"  "roci"  "rpalf" "rpfl" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37] "rpmx"  "rpns"  "rpsh"  "rpsq"  "rpto"  "rptyp" "rsqu"  "rsyn"  "rzya" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [46] "rzygo" "rzyt" </span>
<span class="r-in"><span class="fu">specimens</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "CZCD1_1"  "CZCD1_2"  "CZCD1_7"  "CZCD1_10" "CZCD1_11" "CZCD1_15"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] "CZCD1_16" "CZCD1_18" "CZCD1_20" "CZCD1_21" "CZCD1_23" "CZCD1_24"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] "CZCD1_25" "CZCD1_28" "CZCD1_30" "CZCD1_32" "CZCD1_36" "CZCD1_37"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] "CZCD1_39" "CZCD1_40" "CZCD1_42" "CZCD1_53" "CZCD1_56" "CZCD1_59"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] "CZCD1_65" "CZCD1_66" "CZCD1_72" "CZCD1_73"</span>
<span class="r-in"><span class="fu">dimensions</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "X" "Y" "Z"</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## subsets</span></span>
<span class="r-in"><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EDMA data: Crouzon P0 MUT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 landmarks, 2 dimensions, 5 specimens</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EDMA data: Crouzon P0 MUT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47 landmarks, 3 dimensions, 10 specimens</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## coercion</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  num [1:1316, 1:3] 5.85 2.79 6.86 9.11 8.25 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, "dimnames")=List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : chr [1:1316] "CZCD1_1_amsph" "CZCD1_1_bas" "CZCD1_1_cpsh" "CZCD1_1_ethma" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : chr [1:3] "X" "Y" "Z"</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'data.frame':	1316 obs. of  3 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ X: num  5.85 2.79 6.86 9.11 8.25 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ Y: num  5.98 6.24 5.81 5.82 5.81 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ Z: num  2.2 0.4 3.35 3.91 3.78 ...</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  num [1:1316, 1:3] 5.85 2.79 6.86 9.11 8.25 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, "dimnames")=List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : chr [1:1316] "CZCD1_1_amsph" "CZCD1_1_bas" "CZCD1_1_cpsh" "CZCD1_1_ethma" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : chr [1:3] "X" "Y" "Z"</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">as.array</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  num [1:47, 1:3, 1:28] 5.85 2.79 6.86 9.11 8.25 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, "dimnames")=List of 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : chr [1:47] "amsph" "bas" "cpsh" "ethma" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : chr [1:3] "X" "Y" "Z"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : chr [1:28] "CZCD1_1" "CZCD1_2" "CZCD1_7" "CZCD1_10" ...</span>
<span class="r-in"><span class="fu">as.edma_data</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">as.array</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EDMA data: Landmark data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47 landmarks, 3 dimensions, 28 specimens</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## simulate data</span></span>
<span class="r-in"><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="co"># number of landmarks</span></span>
<span class="r-in"><span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co"># dimension, 2 or 3</span></span>
<span class="r-in"><span class="va">sig</span> <span class="op">&lt;-</span> <span class="fl">0.75</span></span>
<span class="r-in"><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span class="r-in"><span class="va">SigmaK</span> <span class="op">&lt;-</span> <span class="va">sig</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">K</span>, <span class="va">K</span><span class="op">)</span> <span class="op">+</span> <span class="va">sig</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">rho</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">K</span>, <span class="va">K</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">M</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">M</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">M</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"><span class="va">M</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">M</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">M</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"><span class="va">M</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">*</span><span class="va">M</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">edma_simulate_data</span><span class="op">(</span><span class="fl">10</span>, <span class="va">M</span>, <span class="va">SigmaK</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EDMA data: Simulated landmark data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 landmarks, 2 dimensions, 10 specimens</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3" id="pkgdown-sidebar">
    <nav id="toc"><h2>On this page</h2>
    </nav></div>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Peter Solymos, Subhash R. Lele, Theodore M. Cole, Liangyuan Hu, Joan T. Richtsmeier.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.9000.9000.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

